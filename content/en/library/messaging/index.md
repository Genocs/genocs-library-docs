---
title : "Messaging"
description: "Genocs Library is a collection of Enterprise Level Libraries and Templates for Modern Web Applications that gets you started with premium application development in no-time!"
lead: ""
date: 2023-05-13T15:40:19+02:00
lastmod: 2023-05-13T15:40:19+02:00
draft: false
images: []
menu:
  library:
    identifier: "messaging"
    name: "Messaging"
    parent: "library"
weight: 7
toc: true
---


This code snippet is used to send an email using SendGrid. The code snippet is written in C# and uses the SendGrid NuGet package. The code snippet is used to send an email to multiple recipients. The code snippet is written in C# and uses the SendGrid NuGet package. The code snippet is used to send an email to multiple recipients.

```csharp

    private async Task InternalSend(string subject, string content)
    {
        try
        {
            var client = new SendGridClient(_settings.ApiKey);
            var from = new EmailAddress(_settings.Email);
            var plainTextContent = "This email is generated by the system. Please do not respond on this account";

            var recipients = _settings.Recipients.Split(",");
            if (recipients.Length == 1)
            {
                var to = new EmailAddress(_settings.Recipients);
                var msg = MailHelper.CreateSingleEmail(from,
                                                    to,
                                                    subject,
                                                    plainTextContent,
                                                    content);
                var response = await client.SendEmailAsync(msg);
                var res = response.IsSuccessStatusCode;
            }
            else
            {
                var recipientsAddress = new List<EmailAddress>();
                foreach (string recipient in recipients)
                {
                    if (!string.IsNullOrWhiteSpace(recipient))
                    {
                        recipientsAddress.Add(new EmailAddress(recipient.Trim()));
                    }
                }

                var to = new EmailAddress(_settings.Recipients);
                var msg = MailHelper.CreateSingleEmailToMultipleRecipients(from,
                                                    recipientsAddress,
                                                    subject,
                                                    plainTextContent,
                                                    content);

                var response = await client.SendEmailAsync(msg);
                var res = response.IsSuccessStatusCode;
            }
        }
        catch (System.Exception ex)
        {
            _logger.LogError("Error on Send Email", ex);
        }
    }
```